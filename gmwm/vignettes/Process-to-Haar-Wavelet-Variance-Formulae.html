<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="James Balamuta" />

<meta name="date" content="2016-09-04" />

<title>Process to Haar Wavelet Variance Formulae</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Process to Haar Wavelet Variance Formulae</h1>
<h4 class="author"><em>James Balamuta</em></h4>
<h4 class="date"><em>2016-09-04</em></h4>



<p>The following equations are derivations used within the package as they relate to the Haar Wavelet Variance (WV) theoretical quantities. The initial WV formula, <span class="math inline">\(\nu _j^2\)</span>, are used to calculate process to wavelet variance. The later are used within the asymptotic model selection calculations.</p>
<p>The initial equations, marked by <span class="math inline">\(AVa{r_n}\left[ {X\left( t \right)} \right]\)</span>, come from <a href="http://iopscience.iop.org/article/10.1088/0026-1394/45/5/009/meta"><em>Allan variance of time series models for measurement data</em></a> by Nien Fan Zhang published in Metrologia and <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=4404126&amp;tag=1"><em>Analysis and Modeling of Inertial Sensors Using Allan Variance</em></a> by El-Sheimy, et. al. in IEEE Transactions on Instrumentation and Measurement. That is, these equations are derived using the Allan Variance (AV). The relationship between the Allan Variance to the Wavelet Variance is <span class="math inline">\(\frac{1}{2} AVa{r_n}\left[ {X\left( t \right)} \right] = \nu _j^2\)</span>. Note, the <span class="math inline">\(n\)</span> used in the Allan Variance is equivalent to <span class="math inline">\(\frac{\tau_j}{2}\)</span>.</p>
<p>The derivations below were done using <a href="https://www.wolfram.com/mathematica/">Mathematica</a>. The derivation file is available at: <a href="http://smac-group.com/assets/supporting_docs/haar_analytical_derivatives_complete.nb" class="uri">http://smac-group.com/assets/supporting_docs/haar_analytical_derivatives_complete.nb</a></p>
<p>If you notice one of the derivations as being incorrected, please let us know via an issue at <a href="https://github.com/smac-group/gmwm/issues" class="uri">https://github.com/smac-group/gmwm/issues</a>.</p>
<div id="white-noise" class="section level2">
<h2>White Noise</h2>
<p><span class="math display">\[\begin{aligned}
AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{\sigma _X^2}}{n} \\
\nu _j^2\left( {{\sigma ^2}} \right) &amp;= \frac{1}{2}\frac{{{\sigma ^2}}}{{\left( {\frac{{{\tau _j}}}{2}} \right)}} \\
&amp;= \frac{{{\sigma ^2}}}{{{\tau _j}}} \\ 
  \frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {{\sigma ^2}} \right) &amp;= \frac{1}{{{\tau _j}}} \\
  \frac{{{\partial ^2}}}{{\partial {\sigma ^4}}}\nu _j^2\left( {{\sigma ^2}} \right) &amp;= 0  \\ 
\end{aligned}\]</span></p>
</div>
<div id="random-walk" class="section level2">
<h2>Random Walk</h2>
<p><span class="math display">\[\begin{aligned}
AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{2{n^2} + 1}}{{6n}}\sigma _a^2 \\
\nu _j^2\left( {{\gamma ^2}} \right) &amp;= \frac{1}{2}\frac{{\left( {2{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2} + 1} \right){\gamma ^2}}}{{6\left( {\frac{{{\tau _j}}}{2}} \right)}} \\
&amp;= \frac{{\left( {\tau _j^2 + 2} \right){\gamma ^2}}}{{12{\tau _j}}} \\
\frac{\partial }{{\partial \gamma ^2}}\nu _j^2\left( {{\gamma ^2}} \right) &amp;= \frac{{\left( {{\tau _j^2} + 2} \right)}}{{12\tau _j}} \\
\frac{\partial ^2 }{{\partial \gamma ^4}}\nu _j^2\left( {{\gamma ^2}} \right) &amp;= 0 \\
\end{aligned}\]</span></p>
</div>
<div id="drift-process" class="section level2">
<h2>Drift Process</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{{n^2}{\omega ^2}}}{2} \\
  \nu _j^2\left( \omega  \right) &amp;= \frac{1}{2}\frac{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{\omega ^2}}}{2} \\
   &amp;= \frac{{\tau _j^2{\omega ^2}}}{{16}} \\
  \frac{\partial }{{\partial \omega }}\nu _j^2\left( \omega  \right) &amp;= \frac{{\tau _j^2\omega }}{8} \\
  \frac{{{\partial ^2}}}{{\partial {\omega ^2}}}\nu _j^2\left( \omega  \right) &amp;= \frac{{\tau _j^2}}{8} 
\end{aligned}\]</span></p>
</div>
<div id="quantization-noise-qn" class="section level2">
<h2>Quantization Noise (QN)</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{3{Q^2}}}{{{n^2}}} \\
  \nu _j^2\left( Q^2 \right) &amp;= \frac{1}{2}\frac{{3{Q^2}}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}}} \\
   &amp;= \frac{{6{Q^2}}}{{\tau _j^2}} \\ 
   \frac{\partial }{{\partial Q^2}}{\nu _j^2}\left( Q^2  \right) &amp;= \frac{6}{{{\tau _j^2}}} \\
  \frac{{{\partial ^2}}}{{\partial Q^4}}{\nu _j^2}\left( Q^2  \right) &amp;= 0
\end{aligned}\]</span></p>
</div>
<div id="ar-1-process" class="section level2">
<h2>AR 1 Process</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{n - 3{\phi} - n\phi^2 + 4\phi^{n + 1} - \phi^{2n + 1}}}{{{n^2}{{\left( {1 - {\phi}} \right)}^2}\left( {1 - \phi^2} \right)}}\sigma _a^2 \\
  \nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;= \frac{1}{2}\frac{{\left( {\left( {\frac{{{\tau _j}}}{2}} \right) - 3{\phi} - \left( {\frac{{{\tau _j}}}{2}} \right)\phi^2 + 4\phi^{\left( {\frac{{{\tau _j}}}{2}} \right) + 1} - \phi^{2\left( {\frac{{{\tau _j}}}{2}} \right) + 1}} \right){\sigma ^2}}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{{\left( {1 - {\phi}} \right)}^2}\left( {1 - \phi^2} \right)}} \\
   &amp;= \frac{\sigma ^2 \left(\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^3 (\phi +1) \tau _j^2}
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\phi\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\phi}}}\nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;= \frac{2 \sigma ^2 \left(\left(\phi ^2-1\right) \tau _j \left(\phi ^{\tau _j}-2 \phi ^{\frac{\tau _j}{2}}-\phi -1\right)-((3 \phi +2) \phi +1) \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^4 (\phi +1)^2 \tau _j^2} \\ 
  \frac{\partial }{{\partial \phi^2}}\nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;=  \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^5}{{(\phi  + 1)}^3}\tau _j^2}}\left( \begin{aligned}
  &amp;\left( {{\phi ^2} - 1} \right){\tau _j}\left( {2((7\phi  + 4)\phi  + 1){\phi ^{\frac{{{\tau _j}}}{2} - 1}} - ((7\phi  + 4)\phi  + 1){\phi ^{{\tau _j} - 1}} + 3{{(\phi  + 1)}^2}} \right) +  \\
  &amp;{\left( {{\phi ^2} - 1} \right)^2}\tau _j^2\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} +  \\
  &amp;4\left( {{\phi ^2} + \phi  + 1} \right)(3\phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right)
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\sigma ^2\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\sigma ^2}}}{\nu ^2}(\tau ) &amp;= \frac{\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)}{(\phi -1)^3 (\phi +1) \tau _j^2} \\
  \frac{\partial }{{\partial {\sigma ^4}}}{\nu ^2}(\tau ) &amp;= 0
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t both <span class="math inline">\(\sigma ^2\)</span> and <span class="math inline">\(\phi\)</span></strong></p>
<p>Here we opted to take the derivative w.r.t to <span class="math inline">\(\sigma^2\)</span> first and then <span class="math inline">\(\phi\)</span>. The order of derivatives do not matter due to Clairaut’s Theorem.</p>
<p><span class="math display">\[\frac{\partial }{{\partial \phi }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,{\sigma ^2}} \right) = \frac{2 \left(\left(\phi ^2-1\right) \tau _j \left(\phi ^{\tau _j}-2 \phi ^{\frac{\tau _j}{2}}-\phi -1\right)-(\phi  (3 \phi +2)+1) \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^4 (\phi +1)^2 \tau _j^2}
\]</span></p>
</div>
<div id="ma-1-process" class="section level2">
<h2>MA 1 Process</h2>
<p><em>&gt;</em> <strong>NOTE</strong> For the MA(1) process listed in Zhang on Page 552, there is a sign error between equations (21) and (22). This has been corrected here.</p>
<p><span class="math display">\[
\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \left( {1 + \theta^2} \right)\frac{{\left( {n + \left( {2n - 3} \right)\frac{{{\theta}}}{{1 + \theta^2}}} \right)}}{{{n^2}}}\sigma _a^2 \\
  \nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{1}{2}\left( {1 + \theta^2} \right)\frac{{\left( {\left( {\frac{{{\tau _j}}}{2}} \right) + \left( {2\left( {\frac{{{\tau _j}}}{2}} \right) - 3} \right)\frac{{{\theta}}}{{1 + \theta^2}}} \right)}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}}}{\sigma ^2} \\
   &amp;= \frac{{\left( {{{\left( {{\theta} + 1} \right)}^2}{\tau _j} - 6{\theta}} \right){\sigma ^2}}}{{\tau _j^2}} 
\end{aligned}
\]</span></p>
<p><strong>Derivatives w.r.t <span class="math inline">\(\theta\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\theta}}}\nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{{{\sigma ^2}\left( {2\left( {{\theta} + 1} \right){\tau _j} - 6} \right)}}{{\tau _j^2}} \\
  \frac{\partial }{{\partial \theta^2}}\nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{\tau _j}}}
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\sigma ^2\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\sigma ^2}}}{\nu _j^2\left( {{\theta},{\sigma ^2}} \right)} &amp;= \frac{{\left( {{{\left( {{\theta} + 1} \right)}^2}{\tau _j} - 6{\theta}} \right)}}{{\tau _j^2}} \\
  \frac{\partial }{{\partial {\sigma ^4}}}{\nu _j^2\left( {{\theta},{\sigma ^2}} \right)} &amp;= 0
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t both <span class="math inline">\(\sigma ^2\)</span> and <span class="math inline">\(\theta\)</span></strong></p>
<p><span class="math display">\[
\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\theta ,{\sigma ^2}} \right) = \frac{{2(\theta  + 1){\tau _j} - 6}}{{\tau _j^2}}
\]</span></p>
</div>
<div id="arma11" class="section level2">
<h2>ARMA(1,1)</h2>
<p><em>&gt;</em> <strong>NOTE</strong> For the ARMA(1,1) process listed in Zhang on Page 553, he references <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470272848.html">Time Series Analysis: Forecasting and Control</a> by Box G E P and Jenkins G M 1976 that contains an error when describing both the process variance and autocorrelation function (ACF).</p>
<p>In this case, the ARMA(1,1) process variance, <span class="math inline">\(\gamma \left( 0 \right)\)</span>, and first autocovariance,<span class="math inline">\(\gamma \left( 1 \right)\)</span>, is given by:</p>
<p><span class="math display">\[\begin{aligned}
  Var\left( {X\left( t \right)} \right) &amp;= \gamma \left( 0 \right) \\
  &amp;= {\sigma ^2}\frac{{\left( {1 + 2\theta \phi  + {\theta ^2}} \right)}}{{\left( {1 - {\phi ^2}} \right)}}  \\
  \gamma \left( 1 \right) &amp;= {\sigma ^2}\frac{{\left( {1 + \theta \phi } \right)\left( {\phi  + \theta } \right)}}{{\left( {1 - {\phi ^2}} \right)}} 
\end{aligned} \]</span></p>
<p>And the ARMA(1,1)’s autocorrelation function (ACF) is given by:</p>
<p><span class="math display">\[\begin{aligned}
  \rho \left( 1 \right) &amp;= \frac{{\gamma \left( 1 \right)}}{{\gamma \left( 0 \right)}} \\
  &amp; = \frac{{\left( {\phi  + \theta } \right)\left( {1 + \phi \theta } \right)}}{{1 + 2\phi \theta  + {\theta ^2}}} \\
  \rho \left( k \right) &amp;= {\phi ^{k - 1}}\rho \left( 1 \right)
\end{aligned} \]</span></p>
<p>for <span class="math inline">\(k \ge 1\)</span>.</p>
<p>With this in mind, we rederive the Allan Variance for an ARMA(1,1) using Equation 11 on page 551.</p>
<div id="arma11-derivation" class="section level3">
<h3>ARMA(1,1) Derivation</h3>
<p>We begin by stating Equation 11 on page 551:</p>
<p><span class="math display">\[  AVa{r_n}\left[ {X\left( t \right)} \right] = \frac{{n\left( {1 - \rho \left( n \right)} \right) + \sum\limits_{i = 1}^{n - 1} {i\left( {2\rho \left( {n - i} \right) - \rho \left( i \right) - \rho \left( {2n - i} \right)} \right)} }}{{{n^2}}}\sigma _X^2\]</span></p>
<p><strong>Aside:</strong> To continue, we need to solve the series formulation using the recursive properties of ARMA(1,1)’s ACF.</p>
<p><span class="math display">\[\begin{aligned}
\sum\limits_{i = 1}^{n - 1} {i\left( {2\rho \left( {n - i} \right) - \rho \left( i \right) - \rho \left( {2n - i} \right)} \right)}  &amp;= \rho \left( 1 \right)\sum\limits_{i = 1}^{n - 1} {i\left( {2{\phi ^{n - i - 1}} - {\phi ^{i - 1}} - {\phi ^{2n - i - 1}}} \right)} \\
   &amp;= \rho \left( 1 \right)\left( {\frac{{ - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)}}{{{{(\phi  - 1)}^2}\phi }}} \right)\\
   &amp;= \frac{{(\phi \theta  + 1)(\theta  + \phi )\left( { - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)} \right)}}{{{{(\phi  - 1)}^2}\phi \left( {{\theta ^2} + 2\phi \theta  + 1} \right)}}
\end{aligned}\]</span></p>
<p><strong>Returning:</strong> We substitute in to the first equation to obtain the Allan Variance for the ARMA(1,1) process.</p>
<p><span class="math display">\[\begin{aligned}
   &amp;= \frac{{n\left( {1 - {\phi ^{n - 1}}\frac{{\left( {\phi  + \theta } \right)\left( {1 + \phi \theta } \right)}}{{1 + 2\phi \theta  + {\theta ^2}}}} \right) + \frac{{(\phi \theta  + 1)(\theta  + \phi )\left( { - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)} \right)}}{{{{(\phi  - 1)}^2}\phi \left( {{\theta ^2} + 2\phi \theta  + 1} \right)}}}}{{{n^2}}}\left( {\frac{{{\sigma ^2}\left( {{\theta ^2} + 2\theta \phi  + 1} \right)}}{{1 - {\phi ^2}}}} \right)\\
   &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)n(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^n} - 3} \right)\left( {{\phi ^n} - 1} \right)} \right)}}{{{n^2}{{(\phi  - 1)}^3}(\phi  + 1)}}
\end{aligned}\]</span></p>
</div>
<div id="arma11-process" class="section level3">
<h3>ARMA(1,1) Process</h3>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)n(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^n} - 3} \right)\left( {{\phi ^n} - 1} \right)} \right)}}{{{n^2}{{(\phi  - 1)}^3}(\phi  + 1)}} \\
  \nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)\left( {\frac{{{\tau _j}}}{2}} \right)(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^{\left( {\frac{{{\tau _j}}}{2}} \right)}} - 3} \right)\left( {{\phi ^{\left( {\frac{{{\tau _j}}}{2}} \right)}} - 1} \right)} \right)}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{{(\phi  - 1)}^3}(\phi  + 1)}}\left( {\frac{1}{2}} \right) \\
   &amp;=  - \frac{{2{\sigma ^2}\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\ 
\end{aligned} \]</span></p>
<p><strong>Derivative w.r.t <span class="math inline">\(\phi\)</span></strong>:</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial }{{\partial \phi }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
  &amp;{\tau _j}\left( { - {{(\theta  + 1)}^2}(\phi  - 1){{(\phi  + 1)}^2} - 2\left( {{\phi ^2} - 1} \right)(\theta  + \phi )(\theta \phi  + 1){\phi ^{\frac{{{\tau _j}}}{2} - 1}} + \left( {{\phi ^2} - 1} \right)(\theta \phi  + 1)(\theta  + \phi ){\phi ^{{\tau _j} - 1}}} \right) \\
   &amp;- \left( {{\theta ^2}((3\phi  + 2)\phi  + 1) + 2\theta \left( {\left( {{\phi ^2} + \phi  + 3} \right)\phi  + 1} \right) + (3\phi  + 2)\phi  + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right) \\
\frac{{{\partial ^2}}}{{\partial {\phi ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^5}{{(\phi  + 1)}^3}\tau _j^2}}\left( \begin{aligned}
  &amp;{(\phi  - 1)^2}\left( {{{(\phi  + 1)}^2}\left( {{\theta ^2}\phi  + \theta {\phi ^2} + \theta  + \phi } \right)\tau _j^2\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} + \left( {{\phi ^2} - 1} \right)\left( {{\theta ^2}( - \phi ) + \theta \left( {{\phi ^2} + 4\phi  + 1} \right) - \phi } \right){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} - 2{{(\theta  - 1)}^2}\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;- 12{(\phi  + 1)^2}\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;+ 6(\phi  + 1)(\phi  - 1)\left( {\frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} + (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) + (\phi  + 1)\left( { - (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} - \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - {{(\theta  + 1)}^2}\phi {\tau _j}} \right)} \right) \\ 
\end{aligned}  \right)
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t <span class="math inline">\(\theta\)</span>:</strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial \theta }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}\left( {(\theta  + 1)\left( {{\phi ^2} - 1} \right){\tau _j} + \left( {2\theta \phi  + {\phi ^2} + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\
  \frac{{{\partial ^2}}}{{\partial {\theta ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}\left( {\left( {{\phi ^2} - 1} \right){\tau _j} + 2\phi \left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial }{{\partial \sigma ^2 }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{2 \sigma ^2 \left(\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^3 (\phi +1) \tau _j^2} \\
\frac{{{\partial ^2}}}{{\partial {\sigma ^4}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= 0 
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \phi }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
   &amp;- (\phi  - 1)(\phi  + 1)\left( \begin{aligned}
   &amp;- (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
   &amp;- \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
   &amp;- (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
   &amp;- {(\theta  + 1)^2}\phi {\tau _j} \\ 
\end{aligned}  \right) \\
   &amp;+ (\phi  - 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;+ 3(\phi  + 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\ 
\end{aligned}  \right)\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}}\left( {(\theta  + 1)\left( {{\phi ^2} - 1} \right){\tau _j} + \left( {2\theta \phi  + {\phi ^2} + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial \phi }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) =  - \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
  &amp;{\tau _j}\left( \begin{aligned}
  &amp;2(\theta  + 1)(\phi  - 1){(\phi  + 1)^2} \\
   &amp;+ 2\left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
   &amp;- \left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{{\tau _j} - 1}} \\ 
\end{aligned}  \right) \\
   &amp;+ 2\left( {\theta (\phi (3\phi  + 2) + 1) + \phi \left( {{\phi ^2} + \phi  + 3} \right) + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right)\]</span></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
