<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Process to Haar Wavelet Variance Formulae &bull; gmwm</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gmwm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/Quick-Start-Guide.html">Quick Start</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SMAC-Group/gmwm">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Process to Haar Wavelet Variance Formulae</h1>
                        <h4 class="author">James Balamuta</h4>
            
            <h4 class="date">2016-11-05</h4>
          </div>

    
    
<div class="contents">
<p>The following equations are derivations used within the package as they relate to the Haar Wavelet Variance (WV) theoretical quantities. The initial WV formula, <span class="math inline">\(\nu _j^2\)</span>, are used to calculate process to wavelet variance. The later are used within the asymptotic model selection calculations.</p>
<p>The initial equations, marked by <span class="math inline">\(AVa{r_n}\left[ {X\left( t \right)} \right]\)</span>, come from <a href="http://iopscience.iop.org/article/10.1088/0026-1394/45/5/009/meta"><em>Allan variance of time series models for measurement data</em></a> by Nien Fan Zhang published in Metrologia and <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=4404126&amp;tag=1"><em>Analysis and Modeling of Inertial Sensors Using Allan Variance</em></a> by El-Sheimy, et. al. in IEEE Transactions on Instrumentation and Measurement. That is, these equations are derived using the Allan Variance (AV). The relationship between the Allan Variance to the Wavelet Variance is <span class="math inline">\(\frac{1}{2} AVa{r_n}\left[ {X\left( t \right)} \right] = \nu _j^2\)</span>. Note, the <span class="math inline">\(n\)</span> used in the Allan Variance is equivalent to <span class="math inline">\(\frac{\tau_j}{2}\)</span>.</p>
<p>The derivations below were done using <a href="https://www.wolfram.com/mathematica/">Mathematica</a>. The derivation file is available at: <a href="http://smac-group.com/assets/supporting_docs/haar_analytical_derivatives_complete.nb" class="uri">http://smac-group.com/assets/supporting_docs/haar_analytical_derivatives_complete.nb</a></p>
<p>If you notice one of the derivations as being incorrected, please let us know via an issue at <a href="https://github.com/smac-group/gmwm/issues" class="uri">https://github.com/smac-group/gmwm/issues</a>.</p>
<div id="white-noise" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#white-noise" class="anchor"> </a></body></html>White Noise</h2>
<p><span class="math display">\[\begin{aligned}
AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{\sigma _X^2}}{n} \\
\nu _j^2\left( {{\sigma ^2}} \right) &amp;= \frac{1}{2}\frac{{{\sigma ^2}}}{{\left( {\frac{{{\tau _j}}}{2}} \right)}} \\
&amp;= \frac{{{\sigma ^2}}}{{{\tau _j}}} \\ 
  \frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {{\sigma ^2}} \right) &amp;= \frac{1}{{{\tau _j}}} \\
  \frac{{{\partial ^2}}}{{\partial {\sigma ^4}}}\nu _j^2\left( {{\sigma ^2}} \right) &amp;= 0  \\ 
\end{aligned}\]</span></p>
</div>
<div id="random-walk" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#random-walk" class="anchor"> </a></body></html>Random Walk</h2>
<p><span class="math display">\[\begin{aligned}
AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{2{n^2} + 1}}{{6n}}\sigma _a^2 \\
\nu _j^2\left( {{\gamma ^2}} \right) &amp;= \frac{1}{2}\frac{{\left( {2{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2} + 1} \right){\gamma ^2}}}{{6\left( {\frac{{{\tau _j}}}{2}} \right)}} \\
&amp;= \frac{{\left( {\tau _j^2 + 2} \right){\gamma ^2}}}{{12{\tau _j}}} \\
\frac{\partial }{{\partial \gamma ^2}}\nu _j^2\left( {{\gamma ^2}} \right) &amp;= \frac{{\left( {{\tau _j^2} + 2} \right)}}{{12\tau _j}} \\
\frac{\partial ^2 }{{\partial \gamma ^4}}\nu _j^2\left( {{\gamma ^2}} \right) &amp;= 0 \\
\end{aligned}\]</span></p>
</div>
<div id="drift-process" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#drift-process" class="anchor"> </a></body></html>Drift Process</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{{n^2}{\omega ^2}}}{2} \\
  \nu _j^2\left( \omega  \right) &amp;= \frac{1}{2}\frac{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{\omega ^2}}}{2} \\
   &amp;= \frac{{\tau _j^2{\omega ^2}}}{{16}} \\
  \frac{\partial }{{\partial \omega }}\nu _j^2\left( \omega  \right) &amp;= \frac{{\tau _j^2\omega }}{8} \\
  \frac{{{\partial ^2}}}{{\partial {\omega ^2}}}\nu _j^2\left( \omega  \right) &amp;= \frac{{\tau _j^2}}{8} 
\end{aligned}\]</span></p>
</div>
<div id="quantization-noise-qn" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#quantization-noise-qn" class="anchor"> </a></body></html>Quantization Noise (QN)</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{3{Q^2}}}{{{n^2}}} \\
  \nu _j^2\left( Q^2 \right) &amp;= \frac{1}{2}\frac{{3{Q^2}}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}}} \\
   &amp;= \frac{{6{Q^2}}}{{\tau _j^2}} \\ 
   \frac{\partial }{{\partial Q^2}}{\nu _j^2}\left( Q^2  \right) &amp;= \frac{6}{{{\tau _j^2}}} \\
  \frac{{{\partial ^2}}}{{\partial Q^4}}{\nu _j^2}\left( Q^2  \right) &amp;= 0
\end{aligned}\]</span></p>
</div>
<div id="ar-1-process" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#ar-1-process" class="anchor"> </a></body></html>AR 1 Process</h2>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \frac{{n - 3{\phi} - n\phi^2 + 4\phi^{n + 1} - \phi^{2n + 1}}}{{{n^2}{{\left( {1 - {\phi}} \right)}^2}\left( {1 - \phi^2} \right)}}\sigma _a^2 \\
  \nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;= \frac{1}{2}\frac{{\left( {\left( {\frac{{{\tau _j}}}{2}} \right) - 3{\phi} - \left( {\frac{{{\tau _j}}}{2}} \right)\phi^2 + 4\phi^{\left( {\frac{{{\tau _j}}}{2}} \right) + 1} - \phi^{2\left( {\frac{{{\tau _j}}}{2}} \right) + 1}} \right){\sigma ^2}}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{{\left( {1 - {\phi}} \right)}^2}\left( {1 - \phi^2} \right)}} \\
   &amp;= \frac{\sigma ^2 \left(\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^3 (\phi +1) \tau _j^2}
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\phi\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\phi}}}\nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;= \frac{2 \sigma ^2 \left(\left(\phi ^2-1\right) \tau _j \left(\phi ^{\tau _j}-2 \phi ^{\frac{\tau _j}{2}}-\phi -1\right)-((3 \phi +2) \phi +1) \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^4 (\phi +1)^2 \tau _j^2} \\ 
  \frac{\partial }{{\partial \phi^2}}\nu _j^2\left( {{\phi},{\sigma ^2}} \right) &amp;=  \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^5}{{(\phi  + 1)}^3}\tau _j^2}}\left( \begin{aligned}
  &amp;\left( {{\phi ^2} - 1} \right){\tau _j}\left( {2((7\phi  + 4)\phi  + 1){\phi ^{\frac{{{\tau _j}}}{2} - 1}} - ((7\phi  + 4)\phi  + 1){\phi ^{{\tau _j} - 1}} + 3{{(\phi  + 1)}^2}} \right) +  \\
  &amp;{\left( {{\phi ^2} - 1} \right)^2}\tau _j^2\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} +  \\
  &amp;4\left( {{\phi ^2} + \phi  + 1} \right)(3\phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right)
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\sigma ^2\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\sigma ^2}}}{\nu ^2}(\tau ) &amp;= \frac{\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)}{(\phi -1)^3 (\phi +1) \tau _j^2} \\
  \frac{\partial }{{\partial {\sigma ^4}}}{\nu ^2}(\tau ) &amp;= 0
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t both <span class="math inline">\(\sigma ^2\)</span> and <span class="math inline">\(\phi\)</span></strong></p>
<p>Here we opted to take the derivative w.r.t to <span class="math inline">\(\sigma^2\)</span> first and then <span class="math inline">\(\phi\)</span>. The order of derivatives do not matter due to Clairaut&rsquo;s Theorem.</p>
<p><span class="math display">\[\frac{\partial }{{\partial \phi }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,{\sigma ^2}} \right) = \frac{2 \left(\left(\phi ^2-1\right) \tau _j \left(\phi ^{\tau _j}-2 \phi ^{\frac{\tau _j}{2}}-\phi -1\right)-(\phi  (3 \phi +2)+1) \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^4 (\phi +1)^2 \tau _j^2}
\]</span></p>
</div>
<div id="ma-1-process" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#ma-1-process" class="anchor"> </a></body></html>MA 1 Process</h2>
<p><em>&gt;</em> <strong>NOTE</strong> For the MA(1) process listed in Zhang on Page 552, there is a sign error between equations (21) and (22). This has been corrected here.</p>
<p><span class="math display">\[
\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;= \left( {1 + \theta^2} \right)\frac{{\left( {n + \left( {2n - 3} \right)\frac{{{\theta}}}{{1 + \theta^2}}} \right)}}{{{n^2}}}\sigma _a^2 \\
  \nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{1}{2}\left( {1 + \theta^2} \right)\frac{{\left( {\left( {\frac{{{\tau _j}}}{2}} \right) + \left( {2\left( {\frac{{{\tau _j}}}{2}} \right) - 3} \right)\frac{{{\theta}}}{{1 + \theta^2}}} \right)}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}}}{\sigma ^2} \\
   &amp;= \frac{{\left( {{{\left( {{\theta} + 1} \right)}^2}{\tau _j} - 6{\theta}} \right){\sigma ^2}}}{{\tau _j^2}} 
\end{aligned}
\]</span></p>
<p><strong>Derivatives w.r.t <span class="math inline">\(\theta\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\theta}}}\nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{{{\sigma ^2}\left( {2\left( {{\theta} + 1} \right){\tau _j} - 6} \right)}}{{\tau _j^2}} \\
  \frac{\partial }{{\partial \theta^2}}\nu _j^2\left( {{\theta},{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{\tau _j}}}
\end{aligned}\]</span></p>
<p><strong>Derivatives w.r.t. <span class="math inline">\(\sigma ^2\)</span></strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial {\sigma ^2}}}{\nu _j^2\left( {{\theta},{\sigma ^2}} \right)} &amp;= \frac{{\left( {{{\left( {{\theta} + 1} \right)}^2}{\tau _j} - 6{\theta}} \right)}}{{\tau _j^2}} \\
  \frac{\partial }{{\partial {\sigma ^4}}}{\nu _j^2\left( {{\theta},{\sigma ^2}} \right)} &amp;= 0
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t both <span class="math inline">\(\sigma ^2\)</span> and <span class="math inline">\(\theta\)</span></strong></p>
<p><span class="math display">\[
\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\theta ,{\sigma ^2}} \right) = \frac{{2(\theta  + 1){\tau _j} - 6}}{{\tau _j^2}}
\]</span></p>
</div>
<div id="arma11" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#arma11" class="anchor"> </a></body></html>ARMA(1,1)</h2>
<p><em>&gt;</em> <strong>NOTE</strong> For the ARMA(1,1) process listed in Zhang on Page 553, he references <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470272848.html">Time Series Analysis: Forecasting and Control</a> by Box G E P and Jenkins G M 1976 that contains an error when describing both the process variance and autocorrelation function (ACF).</p>
<p>In this case, the ARMA(1,1) process variance, <span class="math inline">\(\gamma \left( 0 \right)\)</span>, and first autocovariance,<span class="math inline">\(\gamma \left( 1 \right)\)</span>, is given by:</p>
<p><span class="math display">\[\begin{aligned}
  Var\left( {X\left( t \right)} \right) &amp;= \gamma \left( 0 \right) \\
  &amp;= {\sigma ^2}\frac{{\left( {1 + 2\theta \phi  + {\theta ^2}} \right)}}{{\left( {1 - {\phi ^2}} \right)}}  \\
  \gamma \left( 1 \right) &amp;= {\sigma ^2}\frac{{\left( {1 + \theta \phi } \right)\left( {\phi  + \theta } \right)}}{{\left( {1 - {\phi ^2}} \right)}} 
\end{aligned} \]</span></p>
<p>And the ARMA(1,1)&rsquo;s autocorrelation function (ACF) is given by:</p>
<p><span class="math display">\[\begin{aligned}
  \rho \left( 1 \right) &amp;= \frac{{\gamma \left( 1 \right)}}{{\gamma \left( 0 \right)}} \\
  &amp; = \frac{{\left( {\phi  + \theta } \right)\left( {1 + \phi \theta } \right)}}{{1 + 2\phi \theta  + {\theta ^2}}} \\
  \rho \left( k \right) &amp;= {\phi ^{k - 1}}\rho \left( 1 \right)
\end{aligned} \]</span></p>
<p>for <span class="math inline">\(k \ge 1\)</span>.</p>
<p>With this in mind, we rederive the Allan Variance for an ARMA(1,1) using Equation 11 on page 551.</p>
<div id="arma11-derivation" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#arma11-derivation" class="anchor"> </a></body></html>ARMA(1,1) Derivation</h3>
<p>We begin by stating Equation 11 on page 551:</p>
<p><span class="math display">\[  AVa{r_n}\left[ {X\left( t \right)} \right] = \frac{{n\left( {1 - \rho \left( n \right)} \right) + \sum\limits_{i = 1}^{n - 1} {i\left( {2\rho \left( {n - i} \right) - \rho \left( i \right) - \rho \left( {2n - i} \right)} \right)} }}{{{n^2}}}\sigma _X^2\]</span></p>
<p><strong>Aside:</strong> To continue, we need to solve the series formulation using the recursive properties of ARMA(1,1)&rsquo;s ACF.</p>
<p><span class="math display">\[\begin{aligned}
\sum\limits_{i = 1}^{n - 1} {i\left( {2\rho \left( {n - i} \right) - \rho \left( i \right) - \rho \left( {2n - i} \right)} \right)}  &amp;= \rho \left( 1 \right)\sum\limits_{i = 1}^{n - 1} {i\left( {2{\phi ^{n - i - 1}} - {\phi ^{i - 1}} - {\phi ^{2n - i - 1}}} \right)} \\
   &amp;= \rho \left( 1 \right)\left( {\frac{{ - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)}}{{{{(\phi  - 1)}^2}\phi }}} \right)\\
   &amp;= \frac{{(\phi \theta  + 1)(\theta  + \phi )\left( { - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)} \right)}}{{{{(\phi  - 1)}^2}\phi \left( {{\theta ^2} + 2\phi \theta  + 1} \right)}}
\end{aligned}\]</span></p>
<p><strong>Returning:</strong> We substitute in to the first equation to obtain the Allan Variance for the ARMA(1,1) process.</p>
<p><span class="math display">\[\begin{aligned}
   &amp;= \frac{{n\left( {1 - {\phi ^{n - 1}}\frac{{\left( {\phi  + \theta } \right)\left( {1 + \phi \theta } \right)}}{{1 + 2\phi \theta  + {\theta ^2}}}} \right) + \frac{{(\phi \theta  + 1)(\theta  + \phi )\left( { - {\phi ^{2n + 1}} + \left( {n{{(\phi  - 1)}^2} + 4\phi } \right){\phi ^n} + \phi ( - 2n(\phi  - 1) - 3)} \right)}}{{{{(\phi  - 1)}^2}\phi \left( {{\theta ^2} + 2\phi \theta  + 1} \right)}}}}{{{n^2}}}\left( {\frac{{{\sigma ^2}\left( {{\theta ^2} + 2\theta \phi  + 1} \right)}}{{1 - {\phi ^2}}}} \right)\\
   &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)n(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^n} - 3} \right)\left( {{\phi ^n} - 1} \right)} \right)}}{{{n^2}{{(\phi  - 1)}^3}(\phi  + 1)}}
\end{aligned}\]</span></p>
</div>
<div id="arma11-process" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#arma11-process" class="anchor"> </a></body></html>ARMA(1,1) Process</h3>
<p><span class="math display">\[\begin{aligned}
  AVa{r_n}\left[ {X\left( t \right)} \right] &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)n(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^n} - 3} \right)\left( {{\phi ^n} - 1} \right)} \right)}}{{{n^2}{{(\phi  - 1)}^3}(\phi  + 1)}} \\
  \nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;=  - \frac{{{\sigma ^2}\left( {(\theta  + 1)\left( {\frac{{{\tau _j}}}{2}} \right)(\phi  - 1)(\theta (\phi  - 1) - \phi  - 2\phi \theta  - 1) - (\phi \theta  + 1)(\theta  + \phi )\left( {{\phi ^{\left( {\frac{{{\tau _j}}}{2}} \right)}} - 3} \right)\left( {{\phi ^{\left( {\frac{{{\tau _j}}}{2}} \right)}} - 1} \right)} \right)}}{{{{\left( {\frac{{{\tau _j}}}{2}} \right)}^2}{{(\phi  - 1)}^3}(\phi  + 1)}}\left( {\frac{1}{2}} \right) \\
   &amp;=  - \frac{{2{\sigma ^2}\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\ 
\end{aligned} \]</span></p>
<p><strong>Derivative w.r.t <span class="math inline">\(\phi\)</span></strong>:</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial }{{\partial \phi }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
  &amp;{\tau _j}\left( { - {{(\theta  + 1)}^2}(\phi  - 1){{(\phi  + 1)}^2} - 2\left( {{\phi ^2} - 1} \right)(\theta  + \phi )(\theta \phi  + 1){\phi ^{\frac{{{\tau _j}}}{2} - 1}} + \left( {{\phi ^2} - 1} \right)(\theta \phi  + 1)(\theta  + \phi ){\phi ^{{\tau _j} - 1}}} \right) \\
   &amp;- \left( {{\theta ^2}((3\phi  + 2)\phi  + 1) + 2\theta \left( {\left( {{\phi ^2} + \phi  + 3} \right)\phi  + 1} \right) + (3\phi  + 2)\phi  + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right) \\
\frac{{{\partial ^2}}}{{\partial {\phi ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^5}{{(\phi  + 1)}^3}\tau _j^2}}\left( \begin{aligned}
  &amp;{(\phi  - 1)^2}\left( {{{(\phi  + 1)}^2}\left( {{\theta ^2}\phi  + \theta {\phi ^2} + \theta  + \phi } \right)\tau _j^2\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} + \left( {{\phi ^2} - 1} \right)\left( {{\theta ^2}( - \phi ) + \theta \left( {{\phi ^2} + 4\phi  + 1} \right) - \phi } \right){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} - 2{{(\theta  - 1)}^2}\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;- 12{(\phi  + 1)^2}\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;+ 6(\phi  + 1)(\phi  - 1)\left( {\frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} + (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) + (\phi  + 1)\left( { - (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} - \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - {{(\theta  + 1)}^2}\phi {\tau _j}} \right)} \right) \\ 
\end{aligned}  \right)
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t <span class="math inline">\(\theta\)</span>:</strong></p>
<p><span class="math display">\[\begin{aligned}
  \frac{\partial }{{\partial \theta }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}\left( {(\theta  + 1)\left( {{\phi ^2} - 1} \right){\tau _j} + \left( {2\theta \phi  + {\phi ^2} + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\
  \frac{{{\partial ^2}}}{{\partial {\theta ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{{2{\sigma ^2}\left( {\left( {{\phi ^2} - 1} \right){\tau _j} + 2\phi \left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} \\
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial }{{\partial \sigma ^2 }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= \frac{2 \sigma ^2 \left(\left(\phi ^2-1\right) \tau _j+2 \phi  \left(\phi ^{\tau _j}-4 \phi ^{\frac{\tau _j}{2}}+3\right)\right)}{(\phi -1)^3 (\phi +1) \tau _j^2} \\
\frac{{{\partial ^2}}}{{\partial {\sigma ^4}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) &amp;= 0 
\end{aligned}\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \phi }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
   &amp;- (\phi  - 1)(\phi  + 1)\left( \begin{aligned}
   &amp;- (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
   &amp;- \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
   &amp;- (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
   &amp;- {(\theta  + 1)^2}\phi {\tau _j} \\ 
\end{aligned}  \right) \\
   &amp;+ (\phi  - 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
   &amp;+ 3(\phi  + 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\ 
\end{aligned}  \right)\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma^2\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}}\left( {(\theta  + 1)\left( {{\phi ^2} - 1} \right){\tau _j} + \left( {2\theta \phi  + {\phi ^2} + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)\]</span></p>
<p><strong>Derivative w.r.t. <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>:</strong></p>
<p><span class="math display">\[\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial \phi }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) =  - \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{aligned}
  &amp;{\tau _j}\left( \begin{aligned}
  &amp;2(\theta  + 1)(\phi  - 1){(\phi  + 1)^2} \\
   &amp;+ 2\left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
   &amp;- \left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{{\tau _j} - 1}} \\ 
\end{aligned}  \right) \\
   &amp;+ 2\left( {\theta (\phi (3\phi  + 2) + 1) + \phi \left( {{\phi ^2} + \phi  + 3} \right) + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{aligned}  \right)\]</span></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#white-noise">White Noise</a></li>
      <li><a href="#random-walk">Random Walk</a></li>
      <li><a href="#drift-process">Drift Process</a></li>
      <li><a href="#quantization-noise-qn">Quantization Noise (QN)</a></li>
      <li><a href="#ar-1-process">AR 1 Process</a></li>
      <li><a href="#ma-1-process">MA 1 Process</a></li>
      <li><a href="#arma11">ARMA(1,1)</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by James Balamuta, Stephane Guerrier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
